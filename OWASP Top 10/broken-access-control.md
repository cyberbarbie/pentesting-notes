# Broken Access Control
My favorite freaking web security vulnerability (so far...)
Brief Summary - The most common web vulnerability according to OWASP Top 10 where you're able to access the data of another user of the same access level (horizontal privilege escalation), elevate to a user of higher access level like admin/root (vertical privilege escalation), or bypass the multi-step process of performing a user action (context-dependent). Ways to prevent it is by validating user input on the server side, testing your functions regularly to ensure proper access control, & deny access by default then implement and test access controls as you go. 

IDOR - Insecure direct object reference; a type of access control vulnerability; when a web server fulfills a user input request to retrieve objects (files, data, documents) that hasn't been validates on the server side to confirm the user has access to requested data 

If the application trusts the client side input, you can change the user ID; anything coming from the client should be considered untrusted by default

Burp suite - all requests from the browser will get sent to the proxy then to the target application; a man in the middle proxy that intercepts requests from the application to server

API Key - Extract information from the client side and you want to extract cookies usually to steal their identity but can use the API key to retrieve other information so you never want to store it in the UI encrypted or unencrypted

Broken access controls can be accessed at the API level.

Methodology - Map the application and how it works, all the business logic, all the potential parameters that talk to the backend and determine where those vulnerabilities exist if access control rules have been implemented incorrect 

Vertical privilege escalation - Finding a type of broken access control vulnerability where you can perform actions reserved for elevated privileged users.

If the application relies on client-side input in order to make access control vulnerabilities 
Don't trust a user to put a dash or a single quote
You need to perform server-side validation

Cookies are client-supplied input 


In a real world pentest, you're given multiple accounts of different privilege levels and your first step is to map out the application to determine what functionality and parts of the application a user role has access to

Ex When logged in as admin 
	- You're given an admin panel link which lets you upgrade and downgrade privilege of users 

You're analyzing the different endpoint requests made based off user action in Burp Suite
GET - Retrieve/view; less secure than POST because data is sent part of the URL
DELETE - delete a resource 
PUT - checking if resource exists then update else create new resource 
POST - create resource/can be used to update 
PATCH - Update aresource 

Prevention against broken access control - 
	- Use a security-centric design where access is verified first and ensure all requests go through access control check
	- Deny access by default when creating a new page and implement rules to grant access
	- Apply the principle of least privilege throughout the entire application
	- Log all access control events 
	- Access control checks should always be performed on the server side, never trust client-provided input 

HTTP is a stateless protocol meaning it doesn't keep track of requests, instead you use something like cookies which will act as your unique identifier and will be sent with each subsequent HTTP request so the server remembers who you are. 

[Learn Burp Suite Here](https://portswigger.net/burp/documentation/desktop/getting-started/intercepting-http-traffic?utm_source=burp_suite_community&utm_medium=learn_tab&utm_campaign=onboarding)
